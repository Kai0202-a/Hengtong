{"ast":null,"code":"import _objectSpread from\"C:/Users/cow7353202th/Desktop/APP/car-parts-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{dealersData}from\"./dealersData\";import{useContext}from\"react\";import{UserContext}from\"../UserContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[loginMsg,setLoginMsg]=useState(\"\");const[registerInfo,setRegisterInfo]=useState({username:\"\",password:\"\",name:\"\",email:\"\",phone:\"\"});const[registerMsg,setRegisterMsg]=useState(\"\");const navigate=useNavigate();useEffect(()=>{const user=JSON.parse(localStorage.getItem(\"user\"));if(!user){// 這裡不需要 navigate(\"/login\")，直接留空或移除即可\n// 或者根本不需要這段 useEffect，因為 Home 就是登入頁\n}},[navigate]);const{setUser}=useContext(UserContext);const handleLogin=async()=>{try{let url=\"\";let role=\"\";if(username.startsWith(\"admin\")){url=\"https://hengtong.vercel.app/api/admin/login\";role=\"admin\";}else{url=\"https://hengtong.vercel.app/api/dealer/login\";role=\"dealer\";}const response=await fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username,password})});const data=await response.json();if(response.ok&&data.token){const userObj={username,role,token:data.token};localStorage.setItem(\"user\",JSON.stringify(userObj));setUser(userObj);setLoginMsg(\"登入成功！\");setTimeout(()=>navigate(role===\"admin\"?\"/admin\":\"/dealer\"),800);}else{setLoginMsg(data.message||\"帳號或密碼錯誤\");}}catch(err){setLoginMsg(\"登入失敗，請稍後再試\");}};const handleRegisterChange=e=>{setRegisterInfo(_objectSpread(_objectSpread({},registerInfo),{},{[e.target.name]:e.target.value}));};const handleRegister=e=>{e.preventDefault();// 檢查帳號是否重複\nif(dealersData.some(d=>d.username===registerInfo.username)){setRegisterMsg(\"帳號已存在，請更換帳號\");return;}// 新增到 dealersData（僅前端模擬，實際應呼叫後端）\ndealersData.push(_objectSpread(_objectSpread({id:dealersData.length+1},registerInfo),{},{status:\"active\"}));setRegisterMsg(\"申請成功，請直接登入\");setRegisterInfo({username:\"\",password:\"\",name:\"\",email:\"\",phone:\"\"});};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',marginTop:0},children:[/*#__PURE__*/_jsx(\"img\",{src:\"images/logo2.png\",alt:\"logo\",style:{width:200,height:200,marginBottom:16}}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#222\",color:\"#fff\",padding:24,borderRadius:8,width:320},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u767B\\u5165\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u5E33\\u865F\",value:username,onChange:e=>setUsername(e.target.value),style:{marginBottom:8,width:\"100%\"}})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"\\u5BC6\\u78BC\",value:password,onChange:e=>setPassword(e.target.value),style:{marginBottom:8,width:\"100%\"}})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,style:{width:\"100%\"},children:\"\\u767B\\u5165\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:loginMsg}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:32,textAlign:'center'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/register'),children:\"\\u7533\\u8ACB\\u5E33\\u865F\"})}),/*#__PURE__*/_jsx(\"div\",{style:{color:'red',marginTop:8},children:registerMsg})]})})]});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","dealersData","useContext","UserContext","jsx","_jsx","jsxs","_jsxs","Home","username","setUsername","password","setPassword","loginMsg","setLoginMsg","registerInfo","setRegisterInfo","name","email","phone","registerMsg","setRegisterMsg","navigate","user","JSON","parse","localStorage","getItem","setUser","handleLogin","url","role","startsWith","response","fetch","method","headers","body","stringify","data","json","ok","token","userObj","setItem","setTimeout","message","err","handleRegisterChange","e","_objectSpread","target","value","handleRegister","preventDefault","some","d","push","id","length","status","style","display","flexDirection","alignItems","marginTop","children","src","alt","width","height","marginBottom","background","color","padding","borderRadius","type","placeholder","onChange","onClick","textAlign"],"sources":["C:/Users/cow7353202th/Desktop/APP/car-parts-frontend/src/pages/Home.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { dealersData } from \"./dealersData\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../UserContext\";\r\n\r\nfunction Home() {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [loginMsg, setLoginMsg] = useState(\"\");\r\n  const [registerInfo, setRegisterInfo] = useState({ username: \"\", password: \"\", name: \"\", email: \"\", phone: \"\" });\r\n  const [registerMsg, setRegisterMsg] = useState(\"\");\r\n  const navigate = useNavigate();\r\n  useEffect(() => {\r\n    const user = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (!user) {\r\n      // 這裡不需要 navigate(\"/login\")，直接留空或移除即可\r\n      // 或者根本不需要這段 useEffect，因為 Home 就是登入頁\r\n    }\r\n  }, [navigate]);\r\n  const { setUser } = useContext(UserContext);\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      let url = \"\";\r\n      let role = \"\";\r\n      if (username.startsWith(\"admin\")) {\r\n        url = \"https://hengtong.vercel.app/api/admin/login\";\r\n        role = \"admin\";\r\n      } else {\r\n        url = \"https://hengtong.vercel.app/api/dealer/login\";\r\n        role = \"dealer\";\r\n      }\r\n      const response = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ username, password })\r\n      });\r\n      const data = await response.json();\r\n      if (response.ok && data.token) {\r\n        const userObj = { username, role, token: data.token };\r\n        localStorage.setItem(\"user\", JSON.stringify(userObj));\r\n        setUser(userObj);\r\n        setLoginMsg(\"登入成功！\");\r\n        setTimeout(() => navigate(role === \"admin\" ? \"/admin\" : \"/dealer\"), 800);\r\n      } else {\r\n        setLoginMsg(data.message || \"帳號或密碼錯誤\");\r\n      }\r\n    } catch (err) {\r\n      setLoginMsg(\"登入失敗，請稍後再試\");\r\n    }\r\n  };\r\n\r\n  const handleRegisterChange = (e) => {\r\n    setRegisterInfo({ ...registerInfo, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleRegister = (e) => {\r\n    e.preventDefault();\r\n    // 檢查帳號是否重複\r\n    if (dealersData.some(d => d.username === registerInfo.username)) {\r\n      setRegisterMsg(\"帳號已存在，請更換帳號\");\r\n      return;\r\n    }\r\n    // 新增到 dealersData（僅前端模擬，實際應呼叫後端）\r\n    dealersData.push({\r\n      id: dealersData.length + 1,\r\n      ...registerInfo,\r\n      status: \"active\"\r\n    });\r\n    setRegisterMsg(\"申請成功，請直接登入\");\r\n    setRegisterInfo({ username: \"\", password: \"\", name: \"\", email: \"\", phone: \"\" });\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: 0 }}>\r\n      <img src=\"images/logo2.png\" alt=\"logo\" style={{ width: 200, height: 200, marginBottom: 16 }} />\r\n      {/* 其餘原本內容放這裡 */}\r\n      <div>\r\n        <div style={{ background: \"#222\", color: \"#fff\", padding: 24, borderRadius: 8, width: 320 }}>\r\n          <h3>登入</h3>\r\n          <div>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"帳號\"\r\n              value={username}\r\n              onChange={e => setUsername(e.target.value)}\r\n              style={{ marginBottom: 8, width: \"100%\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"密碼\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              style={{ marginBottom: 8, width: \"100%\" }}\r\n            />\r\n          </div>\r\n          <button onClick={handleLogin} style={{ width: \"100%\" }}>登入</button>\r\n          <div style={{ marginTop: 8 }}>{loginMsg}</div>\r\n          <div style={{ marginTop: 32, textAlign: 'center' }}>\r\n            <button onClick={() => navigate('/register')}>申請帳號</button>\r\n          </div>\r\n          {/* 申請表單已移除，僅保留按鈕 */}\r\n          <div style={{ color: 'red', marginTop: 8 }}>{registerMsg}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}